<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Server configuration &middot; Ember CLI Mirage
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/style.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>
    <div class="Topbar">
      <div class="Container">
      </div>
    </div>

    <header class="Header">
  <div class="Container">
    <nav class='Header__nav'>
      <ul class='Header__nav-list'>
        <li class='Header__nav-item'>
          <a href='/docs/v0.3.x' class="Header__nav-item-link active">
            <span class="u-mobile">Docs</span>
            <span class="u-desktop">Documentation</span>
          </a>
        </li>
        <li class='Header__nav-item'>
          <a href='/blog' class="Header__nav-item-link">Blog</a>
        </li>
        <li class='Header__nav-item'>
          <a href='/about' class="Header__nav-item-link">About</a>
        </li>
        <li class='Header__nav-item'>
          <a href="http://localhost:4000" class='Header__nav-item-link' target="_blank">GitHub</a>
        </li>
      </ul>
    </nav>
    <a class="Header__logo" href="/">
      <span class='Header__logo-minor'>Ember CLI</span><br>
      <span class='Header__logo-major'>Mirage</span>
    </a>
  </div>
</header>


    <div class="Wrapper">
      <div class="Content">
        

<div class="Side-panel">

  <div class="Mobile-nav">
    <select class="Mobile-nav__toc" onchange="if (this.value) window.location.href=this.value">
      <option value="">Navigate the docs...</option>
      
        


  
  <optgroup label='Getting started'>

<option value="/docs/v0.1.x/">Overview</option>


      
        


<option value="/docs/v0.1.x/installation/">Installation</option>


      
        


<option value="/docs/v0.1.x/quickstart/">Quickstart</option>


      
        


  
    </optgroup>
  
  <optgroup label='Writing your server'>

<option value="/docs/v0.1.x/defining-routes/">Defining routes</option>


      
        


<option value="/docs/v0.1.x/seeding-your-database/">Seeding your database</option>


      
        


<option value="/docs/v0.1.x/acceptance-testing/">Acceptance testing</option>


      
        


  
    </optgroup>
  
  <optgroup label='Cookbook'>

<option value="/docs/v0.1.x/working-with-json-api/">Working with JSON:API</option>


      
        


<option value="/docs/v0.1.x/manually-starting-mirage/">Manually starting Mirage</option>


      
        


<option value="/docs/v0.1.x/simulating-cookie-responses/">Simulating cookie responses</option>


      
        


  
    </optgroup>
  
  <optgroup label='API reference'>

<option value="/docs/v0.1.x/server-configuration/">Server configuration</option>


      
        


<option value="/docs/v0.1.x/routes/">Routes</option>


      
        


<option value="/docs/v0.1.x/shorthands/">Shorthands</option>


      
        


<option value="/docs/v0.1.x/database/">Database</option>


      
        


<option value="/docs/v0.1.x/factories/">Factories</option>

  </optgroup>


      
    </select>

    <div class="Mobile-nav__version">
      <span class='Mobile-nav__version-label'>Version: </span>
      <select class='Mobile-nav__version-select' onchange="if (this.value) window.location.href=this.value">
        
          <option value="/docs/v0.3.x" >v0.3.x</option>
        
          <option value="/docs/v0.2.x" >v0.2.x</option>
        
          <option value="/docs/v0.1.x" selected >v0.1.x</option>
        
          <option value="/docs/v0.0.29" >v0.0.29</option>
        
          <option value="/docs/v0.0.28" >v0.0.28</option>
        
          <option value="/docs/v0.0.27" >v0.0.27</option>
        
      </select>
    </div>
  </div>

  <div class="Desktop-nav">
    <div class="Desktop-nav__version">
      <span class="Desktop-nav__version-label">Version: </span>
      <select class='Desktop-nav__version-select' onchange="if (this.value) window.location.href=this.value">
        
        <option value="/docs/v0.3.x" >v0.3.x</option>
        
        <option value="/docs/v0.2.x" >v0.2.x</option>
        
        <option value="/docs/v0.1.x" selected >v0.1.x</option>
        
        <option value="/docs/v0.0.29" >v0.0.29</option>
        
        <option value="/docs/v0.0.28" >v0.0.28</option>
        
        <option value="/docs/v0.0.27" >v0.0.27</option>
        
      </select>
    </div>

    <ul class="Desktop-nav__toc">
      
        
          <li class='Desktop-nav__section'>Getting started</li>
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/">
    Overview
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/installation/">
    Installation
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/quickstart/">
    Quickstart
  </a>
</li>

      
        
          <li class='Desktop-nav__section'>Writing your server</li>
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/defining-routes/">
    Defining routes
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/seeding-your-database/">
    Seeding your database
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/acceptance-testing/">
    Acceptance testing
  </a>
</li>

      
        
          <li class='Desktop-nav__section'>Cookbook</li>
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/working-with-json-api/">
    Working with JSON:API
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/manually-starting-mirage/">
    Manually starting Mirage
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/simulating-cookie-responses/">
    Simulating cookie responses
  </a>
</li>

      
        
          <li class='Desktop-nav__section'>API reference</li>
        

        

<li>
  <a class="Desktop-nav__item active" href="/docs/v0.1.x/server-configuration/">
    Server configuration
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/routes/">
    Routes
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/shorthands/">
    Shorthands
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/database/">
    Database
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.1.x/factories/">
    Factories
  </a>
</li>

      
    </ul>
  </div>
</div>


<div class="Center-panel">

  <div class="Docs-page">
    <div class='Docs-page__header'>
      <div class="Docs-page__version">
        <a class='Docs-page__improve' href="https://github.com/samselikoff/ember-cli-mirage/edit/gh-pages/docs/v0.1.x/server-configuration.md">
          <small>
            <img class='Docs-page__improve-img' src="/public/images/edit.png" alt="">
            <span class='Docs-page__improve-text'>Improve this page</span>
          </small>
        </a>
      </div>
      <h1 class='Docs-page__title'>Server configuration</h1>
    </div>

    <div class='Docs-page__content'>
      <p>Besides defining your routes, there’s some config options for your server available in <code class="highlighter-rouge">/app/mirage/config.js</code>. There’s also some environment options, which you define in <code class="highlighter-rouge">/config/environment.js</code>.</p>

<h2 id="server-config">Server config</h2>

<p><a name="namespace" href="#namespace">#</a> this.<b>namespace</b></p>

<p>Set the base namespace used for all routes defined with <code class="highlighter-rouge">get</code>, <code class="highlighter-rouge">post</code>, <code class="highlighter-rouge">put</code> or <code class="highlighter-rouge">del</code>.</p>

<p>For example,</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/mirage/config.js</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">namespace</span> <span class="o">=</span> <span class="s1">'/api'</span><span class="p">;</span>

  <span class="c1">// this route will handle the URL '/api/contacts'</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/contacts'</span><span class="p">,</span> <span class="s1">'contacts'</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
</div>

<p>Note that only routes defined after <code class="highlighter-rouge">this.namespace</code> are affected. This is useful if you have a few one-off routes that you don’t want under your namespace:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/mirage/config.js</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="c1">// this route handles /auth</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/auth'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="cm">/* ... */</span><span class="p">});</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">namespace</span> <span class="o">=</span> <span class="s1">'/api'</span><span class="p">;</span>
  <span class="c1">// this route will handle the URL '/api/contacts'</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/contacts'</span><span class="p">,</span> <span class="s1">'contacts'</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
</div>

<p><a name="timing" href="#timing">#</a> this.<b>timing</b></p>

<p>Set the timing parameter of the response. Default is a 400ms delay during development and 0 delay in testing (so your tests run fast).</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/mirage/config.js</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">timing</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span> <span class="c1">// default</span>

<span class="p">};</span>
</code></pre>
</div>

<p><a name="passthrough" href="#passthrough">#</a> this.<strong>passthrough</strong>(<em>path1</em>, <em>path2</em>…, <em>options</em>)</p>

<aside class="Docs-page__aside">
  <p><em>passthrough</em> was added in 0.1.9.</p>
</aside>

<p>By default, if your Ember app makes a request that is not defined in your server config, Mirage will throw an error. You can use <code class="highlighter-rouge">passthrough</code> to whitelist requests, and allow them to pass through your Mirage server to the actual network layer.</p>

<aside class="Docs-page__aside">
  <p>Put all passthrough config at the bottom of your <code>config.js</code> file, to give your route handlers precedence.</p>
</aside>

<p>To ignore paths on your current host (as well as configured <code class="highlighter-rouge">namespace</code>), use a leading <code class="highlighter-rouge">/</code>:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">passthrough</span><span class="p">(</span><span class="s1">'/addresses'</span><span class="p">);</span>
</code></pre>
</div>

<p>You can also pass a list of paths, or call <code class="highlighter-rouge">passthrough</code> multiple time:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">passthrough</span><span class="p">(</span><span class="s1">'/addresses'</span><span class="p">,</span> <span class="s1">'/contacts'</span><span class="p">);</span>
<span class="k">this</span><span class="p">.</span><span class="nx">passthrough</span><span class="p">(</span><span class="s1">'/something'</span><span class="p">);</span>
<span class="k">this</span><span class="p">.</span><span class="nx">passthrough</span><span class="p">(</span><span class="s1">'/else'</span><span class="p">);</span>
</code></pre>
</div>

<p>These lines will allow all HTTP verbs to pass through. If you want only certain verbs to pass through, pass an array as the last argument with the specified verbs:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">passthrough</span><span class="p">(</span><span class="s1">'/addresses'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'post'</span><span class="p">]);</span>
<span class="k">this</span><span class="p">.</span><span class="nx">passthrough</span><span class="p">(</span><span class="s1">'/contacts'</span><span class="p">,</span> <span class="s1">'/photos'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'get'</span><span class="p">]);</span>
</code></pre>
</div>

<p>If you want all requests on the current domain to pass through, simply invoke the method with no arguments:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">passthrough</span><span class="p">();</span>
</code></pre>
</div>

<p>Note again that the current namespace (i.e. any <code class="highlighter-rouge">namespace</code> property defined above this call) will be applied.</p>

<p>You can also allow other-origin hosts to passthrough. If you use a fully-qualified domain name, the <code class="highlighter-rouge">namespace</code> property will be ignored. Use two * wildcards to match all requests under a path:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">passthrough</span><span class="p">(</span><span class="s1">'http://api.foo.bar/**'</span><span class="p">);</span>
<span class="k">this</span><span class="p">.</span><span class="nx">passthrough</span><span class="p">(</span><span class="s1">'http://api.twitter.com/v1/cards/**'</span><span class="p">);</span>
</code></pre>
</div>

<p>Be aware that currently, <code class="highlighter-rouge">passthrough</code> only works with jQuery &gt;= 2.x. See <a href="https://github.com/pretenderjs/pretender/issues/85">this issue</a> for details.</p>

<p><a name="loadFixtures" href="#loadFixtures">#</a> this.<strong>loadFixtures</strong>(<em>file1</em>, <em>file2</em>…)</p>

<aside class="Docs-page__aside">
  <p><em>loadFixtures</em> was added in 0.1.9.</p>
</aside>

<p>By default, all the data files under <code class="highlighter-rouge">/fixtures</code> will be loaded during testing if you don’t have factories defined, and during development if you don’t have <code class="highlighter-rouge">/scenarios/default.js</code> defined. You can use <code class="highlighter-rouge">loadFixtures()</code> to also load fixture files in either of these environments, in addition to using factories to seed your database.</p>

<p><code class="highlighter-rouge">server.loadFixtures()</code> loads all the files, and <code class="highlighter-rouge">server.loadFixtures(file1, file2...)</code> loads selective fixture files.</p>

<p>For example, in a test you may want to start out with all your fixture data loaded:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">test</span><span class="p">(</span><span class="s1">'I can view the photos'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">server</span><span class="p">.</span><span class="nx">loadFixtures</span><span class="p">();</span>
  <span class="nx">server</span><span class="p">.</span><span class="nx">createList</span><span class="p">(</span><span class="s1">'photo'</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>

  <span class="nx">visit</span><span class="p">(</span><span class="s1">'/'</span><span class="p">);</span>

  <span class="nx">andThen</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">equal</span><span class="p">(</span> <span class="nx">find</span><span class="p">(</span><span class="s1">'img'</span><span class="p">).</span><span class="nx">length</span><span class="p">,</span> <span class="mi">10</span> <span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>
</div>

<p>or in development, you may want to load a few reference fixture files, and use factories to define the rest of your data:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// scenarios/default.js</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span><span class="p">(</span><span class="nx">server</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">server</span><span class="p">.</span><span class="nx">loadFixtures</span><span class="p">(</span><span class="s1">'countries'</span><span class="p">,</span> <span class="s1">'states'</span><span class="p">);</span>

  <span class="kd">let</span> <span class="nx">author</span> <span class="o">=</span> <span class="nx">server</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'author'</span><span class="p">);</span>
  <span class="nx">server</span><span class="p">.</span><span class="nx">createList</span><span class="p">(</span><span class="s1">'post'</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">{</span> <span class="na">author_id</span><span class="p">:</span> <span class="nx">author</span><span class="p">.</span><span class="nx">id</span> <span class="p">});</span>
<span class="p">}</span>
</code></pre>
</div>

<p><a name="pretender" href="#pretender">#</a> this.<strong>pretender</strong></p>

<p>Mirage uses <a href="https://github.com/trek/pretender">pretender.js</a> as its xhttp interceptor. In your Mirage config, <code class="highlighter-rouge">this.pretender</code> refers to the actual pretender instance, so any config options that work there will work here as well. By default, content returned is json stringified, so you can just return js objects.</p>

<p>Refer to <a href="https://github.com/trek/pretender#mutating-the-body">pretender’s docs</a> if you want to change this or any other options on your pretender instance.</p>

<p><a name="testConfig" href="#testConfig">#</a> <strong>testConfig</strong></p>

<p>Export a named <code class="highlighter-rouge">testConfig</code> function to define routes that only apply in your test environment:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// mirage/config.js</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// normal config, shared across development + testing</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="kd">function</span> <span class="nx">testConfig</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// test-only config, does not apply to development</span>
<span class="p">}</span>
</code></pre>
</div>

<p>This could be useful if you’d like use Mirage in testing, but generally proxy to an actual API during development. As you develop, your frontend may be ahead of your API, in which case you’d work with the routes in the default config, and write your tests. Then, once your API implements the new endpoints, you can move the routes to your testConfig, so your tests still run, but Mirage doesn’t interfere during development.</p>

<h2 id="environment-options">Environment options</h2>

<p><a name="enabled" href="#enabled">#</a> ENV[‘ember-cli-mirage’].<b>enabled</b></p>

<p>By default, your Mirage server will run in test mode, and in development mode as long as the <code class="highlighter-rouge">--proxy</code> option isn’t passed. To change this default behavior, set <code class="highlighter-rouge">enabled</code> to either true or false in your ENV config.</p>

<p>For example, to enable in production (e.g. to share a working prototype before your server is ready):</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// config/environment.js</span>
<span class="p">...</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">environment</span> <span class="o">===</span> <span class="s1">'production'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">ENV</span><span class="p">[</span><span class="s1">'ember-cli-mirage'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">enabled</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>To disable in development,</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// config/environment.js</span>
<span class="p">...</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">environment</span> <span class="o">===</span> <span class="s1">'development'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">ENV</span><span class="p">[</span><span class="s1">'ember-cli-mirage'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">enabled</span><span class="p">:</span> <span class="kc">false</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

    </div>

    

<div class='Docs-page-nav'>
  
    
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
      
      
      
        
  
         <a class="Docs-page-nav__link u-first" href="/docs/v0.1.x/simulating-cookie-responses/">< Simulating cookie responses</a>
      
  
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
      
      
      
        
  
         <a class="Docs-page-nav__link u-last" href="/docs/v0.1.x/routes/">Routes ></a>
      
  
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
</div>

  </div>
</div>

      </div>
    </div>

    <footer class="Footer">
  <div class="Container Grid Grid--gutters Grid--full med-Grid--fit">
    <div class="Grid-cell">
      <p>Project and site maintained by <a href="https://twitter.com/samselikoff">Sam Selikoff</a> and <a href="https://github.com/samselikoff/ember-cli-mirage/graphs/contributors">contributors</a>.</p>
    </div>
    <div class="Grid-cell">
      <div class="Github-stars">
        <iframe src="https://ghbtns.com/github-btn.html?user=samselikoff&repo=ember-cli-mirage&type=star&count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js"></script>
<script>
  /* global anchors */
  // anchors.options = {
  //   placement: 'left',
  //   visible: 'always'
  // };
  anchors.add('h2:not(.Home-page__feature-heading)');
</script>


  </body>
</html>
